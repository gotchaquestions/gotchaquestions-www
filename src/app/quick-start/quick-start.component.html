<div class="doc-navbar"></div>

<section class="sidenav-content" role="article">
    <h1 class="no-toc">Deploy your own model</h1>
    <p>To run the models need to deploy on <a
      href="https://cloud.google.com/compute/docs/gpus"><code>a2-highgpu-8g</code></a> (currently). This is
      ~$31.44/hour.</p>
    <h2 id="dependenciesfordeploy">Dependencies for deploy</h2>
    <ul>
      <li><a href="https://python.org">Python</a> (2.7 is supported, but 3.7+ is the recommendation)</li>
      <li><a href="https://github.com/offscale/offstrategy">offstrategy</a>, <a
        href="https://github.com/offscale/offregister">offregister</a>, <a
        href="https://github.com/offscale/offregister-llms">offregister-llms</a></li>
      <li><a href="https://etcd.io">etcd</a> (v2 or v3)</li>
      <li>Billing account and auth configured for your cloud provider with a cloud provider with sufficient
        specifications (tested on <a href="https://cloud.google.com">Google Cloud</a> only thus far)
      </li>
    </ul>
    <h2 id="deploytheserver">Deploy the server</h2>
    <h3 id="offstrategyhttpsgithubcomoffscaleoffstrategy"><a href="https://github.com/offscale/offstrategy"><code>offstrategy</code></a>
    </h3>
    <pre><code class="sh language-sh"># JSON file describing Node to create and auth you can base off https://github.com/offscale/offstrategy/blob/master/offstrategy/config/strategy.ubuntu.aws.json
$ python -m offstrategy -n 1 --provider 'EC2' -c 'strategy.ubuntu.aws.json'
# `python -m offswitch -s 'strategy.ubuntu.aws.json'` will delete the VM
</code></pre>
    <h3 id="vagrant">Vagrant</h3>
    <pre><code class="sh language-sh">$ vagrant init generic/rocky8
$ vagrant up  # turn off VM with `vagrant halt`
$ vagrant ssh-config  # Use this in next step, first update ~/.ssh/config and set name to 'rocky'
$ # `vagrant destroy` will delete the VM
</code></pre>
    <p>See Bring Your Own Node (BYON) section below for how to make this available to <a
      href="https://github.com/offscale/offregister"><code>offregister</code></a>.</p>
    <h3 id="otherbyon">Other (BYON)</h3>
    <p>Use any <a href="https://rockylinux.org">Rocky Linux</a> 8 installation.</p>
    <p>Then enable usage in <code>offregister</code> by making this node known to your <a href="https://etcd.io"><code>etcd</code></a>
      cluster:</p>
    <pre><code class="sh language-sh"># You'll need `etcd` running in background for this command:
$ python -m offset --os 'fedora' -u 'vagrant' --dns-name 'rocky' -n 'rocky' \
                   -i "$PWD"'/.vagrant/machines/default/virtualbox/private_key'
</code></pre>
    <h2 id="installllmdependenciesusingthispythonpackageslogic">Install LLM dependencies using this python package's
      logic:</h2>
    <pre><code class="sh language-sh"># You'll need `etcd` running in background for this command:
$ python -m offregister -c 'register.llm.json'  # register.llm.json is a default offregister config; see below
</code></pre>
    <h3 id="registerllmjsonexample"><code>register.llm.json</code> example</h3>
    <p>Make sure you set <code>OFFAUTH_JSON</code> environment variable to your
      https://github.com/offscale/offregister/blob/master/offregister/_config/auth.sample.json</p>
    <pre><code class="json language-json">&lbrace;
  "name": "llm",
  "description": "Offregister strategy for Large Language Models",
  "version": "0.0.1",
  "provider": &lbrace;
    "$ref": "env:OFFAUTH_JSON|offutils.str_from_file | json.loads"
  },
  "register": &lbrace;
    "/unclustered/rocky": [
  &lbrace;
  "module": "offregister-bootstrap",
  "type": "fabric"
      },
  &lbrace;
  "module": "offregister-llms",
  "type": "fabric"
      }
    ]
  },
  "purpose": [
    "llm"
  ],
  "etcd_server": "http://localhost:2379",
  "default_pick": "first"
}
</code></pre>
</section>
